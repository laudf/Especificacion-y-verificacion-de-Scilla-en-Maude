scilla-version 0

iv

library LoveZilliqa
let one = Uint256 1
let tt = true


contract LoveZilliqa
(authorName : String , twitterID : String)

field author_name : String = {authorName}
field twitter_id : String = {twitterID}
field upvote_counter : Uint256 = Uint256 0
field vote_map : Map ByStr20 Bool = Emp ByStr20 Bool

transition upvote(lpv)
  has_voted <-exists vote_map[_sender] ;
  current_vote_count <- upvote_counter ;
  (match has_voted with
  | true =>
    e = {-eventname: "AlreadyVoted" ; current_upvote_count : current_vote_count} ;
    event e
  | false =>
    new_vote_count = builtin add current_vote_count one ;
    vote_map[_sender] := tt ;
    upvote_counter := new_vote_count ;
    e = {-eventname: "Voted" ; shoutout : "Zilliqa loves you!" ; new_vote_count : new_vote_count} ;
    event e
  end)
end

transition whoami(lpv)
 author <- author_name ;
 twitter <- twitter_id ;
 e = {-eventname: "Whoami" ; author_name : author ; twitter_id : twitter} ;
 event e
end